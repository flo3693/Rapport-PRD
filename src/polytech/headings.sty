\def\fileversion{1.0}
\def\filedate{2015/09/01}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{polytech/headings}[\filedate\space\fileversion\space Polytech document class sub package]
\typeout{Package `polytech headings' \fileversion\space<\filedate>}

% header/footer
\csdef{polytech@header@font}{\bfseries\scshape\large}
\csdef{polytech@footer@font}{\bfseries\scshape\large}

\newcommand{\polytech@fancyheadodd}[1]{%
  \begin{tikzpicture}
    \node[
      color=black!50,
      fill=black!50,
      overlay,
      text width=\textwidth + 5cm,
      inner sep=0.2cm,
      inner ysep=0.3cm,
      yshift=0.35cm,
      ] (0,0) {\vspace{1em}} ;
    \node[
      text width=\textwidth,
      inner sep=0cm,
      inner ysep=0cm,
      xshift=0cm,
      color=white,
      anchor=center,
      align=right,
      overlay,
      yshift=0.35cm,
     ] (0,0) {\polytech@header@font#1};
 \end{tikzpicture}%
}

\newcommand{\polytech@fancyheadeven}[1]{%
  \begin{tikzpicture}
    \node[
				color=black!50,
				fill=black!50,
				overlay,
				text width=\textwidth + 5cm,
				inner sep=0.2cm,
				inner ysep=0.3cm,
				yshift=0.35cm,
			] (0,0) {\vspace{1em}} ;
    \node[
	      text width=\textwidth,
	      inner sep=0cm,
	      inner ysep=0cm,
	      xshift=0cm,
	      color=white,
	      anchor=center,
	      align=left,
	      overlay,
	      yshift=0.35cm,
 		] (0,0) {\polytech@header@font#1};
 \end{tikzpicture}%
}

\newcommand{\polytech@fancyfootodd}{%
  \begin{tikzpicture}
    \node[
      text width=\textwidth,
      inner sep=0cm
    ] (mark) {};
  	\node[
      color=white,
      fill=black!50,
      overlay,
      anchor=west,
      inner sep=0.2cm,
      inner ysep=0.3cm,
      xshift=0.5cm,
      text width=5cm
    ] at (mark.east) {\polytech@footer@font\thepage{}} ;
 \end{tikzpicture}%
}

\newcommand{\polytech@fancyfooteven}{%
	\begin{tikzpicture}
    \node[
      text width=\textwidth,
      inner sep=0cm
    ] (mark) {};

    \node[
      color=white,
      fill=black!50,
      overlay,
      anchor=east,
      inner sep=0.2cm,
      inner ysep=0.3cm,
      xshift=-0.5cm,
      text width=5cm,
      align=right
    ] at (mark.west) {\polytech@footer@font\thepage{}} ;
 	\end{tikzpicture}%
}

\pagestyle{fancy}

%% common settings
\fancyhf{} % clear all header and footer fields
\fancyhead[CO]{\polytech@fancyheadodd{\leftmark}}
\fancyhead[CE]{\polytech@fancyheadeven{\leftmark}}
\fancyfoot[CO]{\polytech@fancyfootodd}
\fancyfoot[CE]{\polytech@fancyfooteven}

\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\fancypagestyle{plain}{
  \fancyhead[H]{}
	\fancyfoot[CO]{\polytech@fancyfootodd}
	\fancyfoot[CE]{\polytech@fancyfooteven}
}

\fancypagestyle{empty}{
  \fancyhead[H]{}
  \fancyfoot[F]{}
}

\renewcommand{\chaptermark}[1]{\markboth{\thechapter\xspace#1}{}}


% %Make empty page really empty
% \def\cleardoublepage{%
%   \clearpage%
%   \if@twoside%
%     \ifodd\c@page%
%     \else%
%       \hbox{}%
%       \thispagestyle{empty}%
%       \newpage%
%       \if@twocolumn%
%         \hbox{}%
%         \newpage%
%       \fi%
%     \fi%
%   \fi%
% }



\patchcmd{\thebibliography}%
{\MakeUppercase}%
{}%
{}
{}


\patchcmd{\tableofcontents}%
{\MakeUppercase}%
{}%
{}
{}


\patchcmd{\listoftables}%
{\MakeUppercase}%
{}%
{}
{}


\patchcmd{\listoffigures}%
{\MakeUppercase}%
{}%
{}
{}


\patchcmd{\lstlistoflistings}%
{\MakeUppercase}%
{}%
{}
{}


