\def\fileversion{1.0}
\def\filedate{2015/09/01}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{polytech/weeklyreports}[\filedate\space\fileversion\space Polytech document class sub package]
\typeout{Package `polytech weeklyreports' \fileversion\space<\filedate>}



% lost in translations :)
\def\polytech@weeklyreports@title@en{Weekly reports}
\def\polytech@weeklyreports@title@fr{Comptes rendus hebdomadaires}
\newcommand{\polytech@weeklyreports@reporttitle@en}[2]{Report ###1 (#2)}
\newcommand{\polytech@weeklyreports@reporttitle@fr}[2]{Compte rendu nÂ°#1\xspace du #2}


% the weekly report counter
\newcounter{polytech@weeklyreport@counter}

\notbool{polytech@hideweeklyreports}{%
	% weekly reports enabled
	\csdef{polytech@output@weeklyreports}{}

	\newcommand{\weeklyreport}[2]{%
		\global\appto{\polytech@output@weeklyreports}{
			\begingroup
				\setlength{\FrameSep}{0.1cm}
				\begin{oframed}
				\setlength{\linewidth}{\textwidth-40pt}
				\refstepcounter{polytech@weeklyreport@counter}%
				\textbf{%
					\csuse{polytech@weeklyreports@reporttitle@\csuse{polytech@lang}}{\thepolytech@weeklyreport@counter}{#1}\nopagebreak[4]
				}\nopagebreak[4]\par\nopagebreak[4]
				\hrule\nopagebreak[4]
				\widowpenalty=10000 % change linebreaking penalty to reduce isolated body lines
				\clubpenalty=10000
				#2
				\end{oframed}
			\endgroup
		}
	}

	\csdef{polytech@output@weeklyreportspart}{
		\part*{\csuse{polytech@weeklyreports@title@\csuse{polytech@lang}}}
		\@mkboth{\csuse{polytech@weeklyreports@title@\csuse{polytech@lang}}}{\csuse{polytech@weeklyreports@title@\csuse{polytech@lang}}}
		\vspace{2cm}
		\csuse{polytech@output@weeklyreports}
	}
}{%
	% weekly reports are disabled
	\newcommand{\weeklyreport}[2]{}%
	\csdef{polytech@output@weeklyreportspart}{}
}
